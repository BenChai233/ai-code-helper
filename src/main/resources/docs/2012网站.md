可见性：

动态sql：通过 MyBatis 拦截器在运行时修改 SQL

在 SQL 查询中使用特殊的语法 ##CONDITION$and~~$字段名~~$别名## 进行数据过滤

数据注入到基类字段，可优化为在DataManager类里声明个静态变量ThreadLocal，将数据注入到ThreadLocal里



评论区

主导重构评论区模块，支持富文本评论，并通过引入Reids、异步处理与线程池优化

全平台替换占位符，大搜不能查出占位符，采用redis维护评论统计数。文字同步审核异步处理查状态。



横向连接优化cte写法



设计模式

策略模式：

模板方法+策略模式：消息中心，抽象模板算法：查消息主体+子类处理消息+处理头像，子类具体实现根据消息类型查文章状态、评论状态、活动状态

版本公告：

第一版：插入消息表，用户查消息的时候union all（not exist）公告消息并排序，插入消息用户表

第二版：维护在线用户，主动推送到在线用户Redis缓存中。用户登录时拉取数据库表中群发消息。

责任链模式：推荐位过滤相同内容，链式处理传递过滤的id。



微服务数量

1.content模块

2.admin模块-组织账号、角色权限

3.message模块-所有消息模块如消息中心、应用号服务（点对点、服务推送）。

4.Thirdparty模块-负责与外部系统对接（茶思屋、外部审核、应用号）

5.log模块-记录操作日志

6.ai模块（智能机器人、ai摘要、智能推荐）

7.search模块-对接灵犀平台

8.三张地图模块

9.技术合作模块

10.media模块

11.gateway模块









